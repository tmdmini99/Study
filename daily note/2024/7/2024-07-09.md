
자동완성
```js
$('.search-route').autocomplete
```


엑셀 스타일 설정
```java
public static XSSFCellStyle redCellStyle(XSSFWorkbook workBook) {  
    XSSFCellStyle style = workBook.createCellStyle();  
    XSSFDataFormat format = workBook.createDataFormat();  
    style.setBorderBottom(BorderStyle.THIN);  
    style.setBottomBorderColor(IndexedColors.BLACK.getIndex());  
    style.setBorderTop(BorderStyle.THIN);  
    style.setTopBorderColor(IndexedColors.BLACK.getIndex());  
    style.setBorderLeft(BorderStyle.THIN);  
    style.setLeftBorderColor(IndexedColors.BLACK.getIndex());  
    style.setBorderRight(BorderStyle.THIN);  
    style.setRightBorderColor(IndexedColors.BLACK.getIndex());  
    style.setAlignment(HorizontalAlignment.CENTER);  
    style.setVerticalAlignment(VerticalAlignment.CENTER);  
    style.setDataFormat(format.getFormat("#,##0"));  
  
    XSSFFont redFont = workBook.createFont();  
    redFont.setFontName("맑은 고딕");  
    redFont.setColor(IndexedColors.RED.getIndex());  
    style.setFont(redFont);  
  
    return style;  
}
```

자바 엑셀  쓰는법
```java
XSSFWorkbook workBook = getXSSFWorkbook(session.getServletContext().getRealPath("/WEB-INF/excel/rate/GBMS05100.xlsx"));  
XSSFSheet sheet = workBook.getSheetAt(0);  
XSSFCellStyle style = ExcelUtil.cellStyle(workBook);  
XSSFCellStyle redStyle = ExcelUtil.cellStyle(workBook);  
XSSFFont redFont = workBook.createFont();  
redFont.setColor(IndexedColors.RED.getIndex());  
redStyle.setFont(redFont);  
  
int lastCellNum = ExcelUtil.getLastCellNum(workBook);  
//  데이터 조회  
List<GBMS05100Vo> list = (List<GBMS05100Vo>) service.selectList(paramVo);  
  
if (list != null) {  
    //  엑셀 내용 수정  
    for (int i=0; i < list.size(); i++) {  
        XSSFRow row = sheet.createRow(3+i);  
        row.createCell(0).setCellValue(i+1);  
        row.createCell(1).setCellValue(list.get(i).getRunYmd());  
        row.createCell(2).setCellValue(list.get(i).getRunTobNm());  
        row.createCell(3).setCellValue(list.get(i).getCompNm());  
        row.createCell(4).setCellValue(list.get(i).getRouteNm());  
        row.createCell(5).setCellValue(list.get(i).getRouteRunTypeNm());  
        row.createCell(6).setCellValue(list.get(i).getVehNo());  
        row.createCell(7).setCellValue(list.get(i).getCollRate() + "%");  
  
  
        XSSFCell cell = row.createCell(7);  
        double collRate = Double.parseDouble(list.get(i).getCollRate());  
        cell.setCellValue(collRate + "%");  
  
        // 조건에 따라 스타일 적용  
        if (collRate <= 90) {  
            cell.setCellStyle(redStyle);  
        } else {  
            cell.setCellStyle(style);  
        }  
  
        for(int j=0; j<lastCellNum; j++) {  
            if (j != 7) { // collRate 셀 제외  
                row.getCell(j).setCellStyle(style);  
            }  
        }  
    }  
}  
//  엑셀 다운로드 처리  
response.setContentType("ms-vnd/excel");  
String fileName = URLEncoder.encode("차량별수집율.xlsx", StandardCharsets.UTF_8.toString());  
response.setHeader("Content-Disposition", "attachment; filename=" + fileName);  
workBook.write(response.getOutputStream());  
workBook.close();
```



소수점 색깔 변경 String으로 주고 값만 double로 변경해서 비교
```java
@RequestMapping(value = "/04500ExcelDown.bms", method = RequestMethod.POST)  
public String excelDown(HttpSession session, HttpServletRequest request, HttpServletResponse response, @ModelAttribute("BasicParamVo") BasicParamVo paramVo, Authentication auth) throws IOException {  
  
    log.info(paramVo);  
  
    try {  
        // 엑셀 파일 열기  
        XSSFWorkbook workBook = getXSSFWorkbook(session.getServletContext().getRealPath("/WEB-INF/excel/rate/GBMS04500.xlsx"));  
        XSSFSheet sheet = workBook.getSheetAt(0);  
        XSSFCellStyle style = ExcelUtil.cellStyle(workBook);  
        XSSFCellStyle redStyle = ExcelUtil.redCellStyle(workBook);  
        int lastCellNum = ExcelUtil.getLastCellNum(workBook);  
        // 데이터 조회  
        List<GBMS04500Vo> list = (List<GBMS04500Vo>) service.selectList(paramVo);  
  
        if (list != null) {  
            // 엑셀 내용 수정  
            for (int i = 0; i < list.size(); i++) {  
                XSSFRow row = sheet.createRow(3 + i);  
                row.createCell(0).setCellValue(i + 1);  
                row.createCell(1).setCellValue(list.get(i).getClctYmd());  
                row.createCell(2).setCellValue(list.get(i).getRunTobNm());  
                row.createCell(3).setCellValue(list.get(i).getCompNm());  
                row.createCell(4).setCellValue(list.get(i).getRouteNm());  
                row.createCell(5).setCellValue(list.get(i).getRouteRunTypeNm());  
                row.createCell(6).setCellValue(list.get(i).getPerRunVehCnt());  
                row.createCell(7).setCellValue(list.get(i).getRealRunVehCnt());  
                row.createCell(8).setCellValue(list.get(i).getRcntSum());  
                row.createCell(9).setCellValue(list.get(i).getRealRunCnt());  
                row.createCell(12).setCellValue(list.get(i).getOrgCdNm());  
                // 처리할 셀 (10번째, 11번째)  
                for (int j = 10; j <= 11; j++) {  
                    XSSFCell cell = row.createCell(j);  
                    String value = j == 10 ? list.get(i).getOperRate() : list.get(i).getOperRate2();  
  
                    double collRate;  
                    if (value == null || value.isEmpty()) {  
                        collRate = 0; // 기본값 설정 (예: 0)  
                    } else {  
                        collRate = Double.parseDouble(value);  
                    }  
  
                    cell.setCellValue(value+"%"); // 소수점 이하 두 자리까지 포맷팅하여 문자열로 설정  
                    // 조건에 따라 스타일 적용  
                    if (collRate <= 90) {  
                        cell.setCellStyle(redStyle);  
                    } else {  
                        cell.setCellStyle(style);  
                    }  
                }  
  
                // 나머지 셀 스타일 적용  
                for (int j = 0; j < lastCellNum; j++) {  
                    if (j != 10 && j != 11) { // collRate 셀 제외  
                        row.getCell(j).setCellStyle(style);  
                    }  
                }  
            }  
        }  
  
        //  엑셀 다운로드 처리  
        response.setContentType("ms-vnd/excel");  
        String fileName = URLEncoder.encode("운행횟수 준수율.xlsx", StandardCharsets.UTF_8.toString());  
        response.setHeader("Content-Disposition", "attachment; filename=" + fileName);  
        workBook.write(response.getOutputStream());  
        workBook.close();  
    } catch(Exception e){  
        e.printStackTrace();  
    }  
    return "view";  
}
```